!function($){$.fn.theiaStickySidebar=function(options){function tryInit(options,$that){return!0===options.initialized||!($("body").width()<options.minWidth)&&(function(options,$that){options.initialized=!0,0===$("#theia-sticky-sidebar-stylesheet-"+options.namespace).length&&$("head").append($('<style id="theia-sticky-sidebar-stylesheet-'+options.namespace+'">.theiaStickySidebar:after {content: ""; display: table; clear: both;}</style>'));$that.each(function(){var o={};if(o.sidebar=$(this),o.options=options||{},o.container=$(o.options.containerSelector),0==o.container.length&&(o.container=o.sidebar.parent()),o.sidebar.parents().css("-webkit-transform","none"),o.sidebar.css({position:o.options.defaultPosition,overflow:"visible","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),o.stickySidebar=o.sidebar.find(".theiaStickySidebar"),0==o.stickySidebar.length){var javaScriptMIMETypes=/(?:text|application)\/(?:x-)?(?:javascript|ecmascript)/i;o.sidebar.find("script").filter(function(index,script){return 0===script.type.length||script.type.match(javaScriptMIMETypes)}).remove(),o.stickySidebar=$("<div>").addClass("theiaStickySidebar").append(o.sidebar.children()),o.sidebar.append(o.stickySidebar)}o.marginBottom=parseInt(o.sidebar.css("margin-bottom")),o.paddingTop=parseInt(o.sidebar.css("padding-top")),o.paddingBottom=parseInt(o.sidebar.css("padding-bottom"));var collapsedTopHeight=o.stickySidebar.offset().top,collapsedBottomHeight=o.stickySidebar.outerHeight();function resetSidebar(){o.fixedScrollTop=0,o.sidebar.css({"min-height":"1px"}),o.stickySidebar.css({position:"static",width:"",transform:"none"})}o.stickySidebar.css("padding-top",1),o.stickySidebar.css("padding-bottom",1),collapsedTopHeight-=o.stickySidebar.offset().top,collapsedBottomHeight=o.stickySidebar.outerHeight()-collapsedBottomHeight-collapsedTopHeight,0==collapsedTopHeight?(o.stickySidebar.css("padding-top",0),o.stickySidebarPaddingTop=0):o.stickySidebarPaddingTop=1,0==collapsedBottomHeight?(o.stickySidebar.css("padding-bottom",0),o.stickySidebarPaddingBottom=0):o.stickySidebarPaddingBottom=1,o.previousScrollTop=null,o.fixedScrollTop=0,resetSidebar(),o.onScroll=function(o){if(o.stickySidebar.is(":visible"))if($("body").width()<o.options.minWidth)resetSidebar();else{if(o.options.disableOnResponsiveLayouts){var sidebarWidth=o.sidebar.outerWidth("none"==o.sidebar.css("float"));if(sidebarWidth+50>o.container.width())return void resetSidebar()}var e,height,scrollTop=$(document).scrollTop(),position="static";if(scrollTop>=o.sidebar.offset().top+(o.paddingTop-o.options.additionalMarginTop)){var windowOffsetBottom,offsetTop=o.paddingTop+options.additionalMarginTop,offsetBottom=o.paddingBottom+o.marginBottom+options.additionalMarginBottom,containerTop=o.sidebar.offset().top,containerBottom=o.sidebar.offset().top+(e=o.container,height=e.height(),e.children().each(function(){height=Math.max(height,$(this).height())}),height),windowOffsetTop=0+options.additionalMarginTop,sidebarSmallerThanWindow=o.stickySidebar.outerHeight()+offsetTop+offsetBottom<$(window).height();windowOffsetBottom=sidebarSmallerThanWindow?windowOffsetTop+o.stickySidebar.outerHeight():$(window).height()-o.marginBottom-o.paddingBottom-options.additionalMarginBottom;var staticLimitTop=containerTop-scrollTop+o.paddingTop,staticLimitBottom=containerBottom-scrollTop-o.paddingBottom-o.marginBottom,top=o.stickySidebar.offset().top-scrollTop,scrollTopDiff=o.previousScrollTop-scrollTop;"fixed"==o.stickySidebar.css("position")&&"modern"==o.options.sidebarBehavior&&(top+=scrollTopDiff),"stick-to-top"==o.options.sidebarBehavior&&(top=options.additionalMarginTop),"stick-to-bottom"==o.options.sidebarBehavior&&(top=windowOffsetBottom-o.stickySidebar.outerHeight()),top=scrollTopDiff>0?Math.min(top,windowOffsetTop):Math.max(top,windowOffsetBottom-o.stickySidebar.outerHeight()),top=Math.max(top,staticLimitTop),top=Math.min(top,staticLimitBottom-o.stickySidebar.outerHeight());var sidebarSameHeightAsContainer=o.container.height()==o.stickySidebar.outerHeight();position=(sidebarSameHeightAsContainer||top!=windowOffsetTop)&&(sidebarSameHeightAsContainer||top!=windowOffsetBottom-o.stickySidebar.outerHeight())?scrollTop+top-o.sidebar.offset().top-o.paddingTop<=options.additionalMarginTop?"static":"absolute":"fixed"}if("fixed"==position){var scrollLeft=$(document).scrollLeft();o.stickySidebar.css({position:"fixed",width:getWidthForObject(o.stickySidebar)+"px",transform:"translateY("+top+"px)",left:o.sidebar.offset().left+parseInt(o.sidebar.css("padding-left"))-scrollLeft+"px",top:"0px"})}else if("absolute"==position){var css={};"absolute"!=o.stickySidebar.css("position")&&(css.position="absolute",css.transform="translateY("+(scrollTop+top-o.sidebar.offset().top-o.stickySidebarPaddingTop-o.stickySidebarPaddingBottom)+"px)",css.top="0px"),css.width=getWidthForObject(o.stickySidebar)+"px",css.left="",o.stickySidebar.css(css)}else"static"==position&&resetSidebar();"static"!=position&&1==o.options.updateSidebarHeight&&o.sidebar.css({"min-height":o.stickySidebar.outerHeight()+o.stickySidebar.offset().top-o.sidebar.offset().top+o.paddingBottom}),o.previousScrollTop=scrollTop}},o.onScroll(o),$(document).on("scroll."+o.options.namespace,function(o){return function(){o.onScroll(o)}}(o)),$(window).on("resize."+o.options.namespace,function(o){return function(){o.stickySidebar.css({position:"static"}),o.onScroll(o)}}(o)),"undefined"!=typeof ResizeSensor&&new ResizeSensor(o.stickySidebar[0],function(o){return function(){o.onScroll(o)}}(o))})}(options,$that),!0)}function getWidthForObject(object){var width;try{width=object[0].getBoundingClientRect().width}catch(err){}return void 0===width&&(width=object.width()),width}return(options=$.extend({containerSelector:"",additionalMarginTop:0,additionalMarginBottom:0,updateSidebarHeight:!0,minWidth:0,disableOnResponsiveLayouts:!0,sidebarBehavior:"modern",defaultPosition:"relative",namespace:"TSS"},options)).additionalMarginTop=parseInt(options.additionalMarginTop)||0,options.additionalMarginBottom=parseInt(options.additionalMarginBottom)||0,function(options,$that){tryInit(options,$that)||(console.log("TSS: Body width smaller than options.minWidth. Init is delayed."),$(document).on("scroll."+options.namespace,function(options,$that){return function(evt){var success=tryInit(options,$that);success&&$(this).unbind(evt)}}(options,$that)),$(window).on("resize."+options.namespace,function(options,$that){return function(evt){var success=tryInit(options,$that);success&&$(this).unbind(evt)}}(options,$that)))}(options,this),this}}(jQuery);